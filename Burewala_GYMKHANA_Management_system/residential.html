<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>BGMS — Residential Management</title>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- Bootstrap 5 CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<!-- Bootstrap Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
<!-- FullCalendar CSS -->
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css" rel="stylesheet">
<!-- Date Range Picker CSS -->
<link href="https://cdn.jsdelivr.net/npm/daterangepicker@3.1.0/daterangepicker.css" rel="stylesheet">

  <!-- Custom CSS -->
  <link href="assets/css/styles.css" rel="stylesheet">
  <link href="assets/css/responsive.css" rel="stylesheet">

  <style>
    /* Additional responsive calendar styles */
    .fc .fc-toolbar {
        flex-wrap: wrap;
        gap: 0.5rem;
    }
    
    .fc-toolbar-chunk {
        display: flex;
        flex-wrap: wrap;
        gap: 0.25rem;
    }
    
    .fc-button {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    
    /* Improve calendar event display */
    .fc-daygrid-event {
        margin: 1px 0;
        border-radius: 3px;
        overflow: hidden;
    }
    
    .fc-daygrid-dot-event {
        flex-direction: column;
    }
    
    .fc-daygrid-event-dot {
        margin: 0;
        border-width: 4px;
    }
    
    /* Better event text wrapping */
    .fc-event-title {
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
  
        -webkit-box-orient: vertical;
        line-height: 1.2;
    }
    
    .fc .fc-prev-button{
      color: black;
    }
    .fc .fc-next-button{
      color: black;
    }
    /* Mobile-specific event styles */
    @media (max-width: 768px) {
        .fc-event {
            border-left-width: 4px !important;
            border-left-style: solid !important;
            border-right: none !important;
            border-top: none !important;
            border-bottom: none !important;
            background-color: rgba(255, 255, 255, 0.9) !important;
        }
        
        .fc-event-title {
            font-weight: 600;
        }
        
        /* Make time slots more touch-friendly */
        .fc-timegrid-slot {
            min-height: 40px;
        }
        
        .fc-timegrid-slot-label {
            padding: 4px !important;
        }
    }
    
    /* Print styles for calendar */
    @media print {
        .calendar-container {
            height: auto !important;
            page-break-inside: avoid;
        }
        
        .fc .fc-toolbar {
            display: none !important;
        }
        
        .fc-view {
            border: 1px solid #000 !important;
        }
        
        .fc-event {
            background-color: #fff !important;
            color: #000 !important;
            border: 1px solid #000 !important;
        }
    }
</style>
</head>

<body>

  <!-- TOPBAR -->
  <!-- TOPBAR -->
  <header class="topbar d-flex align-items-center justify-content-between px-3">
    <div class="topbar-header px-3 py-1 d-flex align-items-center gap-2">
      <div class="admin-logo-box">
        <img src="assets/images/logo.png" alt="">
      </div>
    </div>

    <!-- RIGHT ACTIONS -->
    <div style="flex-direction: column;" class="d-flex  align-items-center gap-3">
      <div class="role-switcher">
        <select id="roleSelect" class="form-select form-select-sm">
          <option value="superadmin">Super Admin</option>
          <option value="finance">Finance Officer</option>
          <option value="membership">Membership Officer</option>
        </select>
      </div>

      <div class="profile-dropdown dropdown">
        <button class="btn btn-sm btn-light dropdown-toggle" data-bs-toggle="dropdown">
          <i class="bi bi-person-circle me-1"></i>My Profile
        </button>
        <ul class="dropdown-menu dropdown-menu-end">
          <li><a class="dropdown-item" href="#">My Profile</a></li>
          <li><a class="dropdown-item" href="#">Change Password</a></li>
          <li>
            <hr class="dropdown-divider">
          </li>
          <li><a class="dropdown-item" href="#">Logout</a></li>
        </ul>
      </div>
       <button class="mobile-menu-toggle mobile-only ms-2" id="mobileMenuToggle">
        <i class="bi bi-list"></i>
      </button>
    </div>
  </header>

  <div class="app-root d-flex">
    <!-- SIDEBAR -->
    <aside class="sidebar d-flex flex-column" id="sidebar">
      <nav class="nav flex-column px-2" id="main-nav">
        <a class="nav-link d-flex align-items-center" data-role="all" href="superadmin.html">
          <i class="bi bi-speedometer2 me-2"></i><span>Dashboard</span>
        </a>
        <a class="nav-link d-flex align-items-center" data-role="all" href="members.html">
          <i class="bi bi-people-fill me-2"></i><span>Members</span>
        </a>
        <a class="nav-link d-flex align-items-center" data-role="all" href="users.html">
          <i class="bi bi-people-fill me-2"></i><span>Users</span>
        </a>
        <a class="nav-link d-flex align-items-center" data-role="all" href="billing.html">
          <i class="bi bi-receipt-cutoff me-2"></i><span>Billing</span>
        </a>
        <a class="nav-link d-flex align-items-center" data-role="all" href="payments.html">
          <i class="bi bi-credit-card me-2"></i><span>Payments</span>
        </a>
        <a class="nav-link d-flex align-items-center" data-role="all" href="reports.html">
          <i class="bi bi-file-bar-graph me-2"></i><span>Reports</span>
        </a>
        <a class="nav-link d-flex align-items-center" data-role="all" href="accounting.html">
          <i class="bi bi-bank me-2"></i><span>Accounting</span>
        </a>
        <a class="nav-link d-flex align-items-center" data-role="all" href="facilities.html">
          <i class="bi bi-card-checklist me-2"></i><span>Facilities</span>
        </a>
        <a class="nav-link d-flex align-items-center active" data-role="finance" href="residential.html">
          <i class="bi bi-houses me-2"></i><span>Residential</span>
        </a>
        <a class="nav-link d-flex align-items-center" data-role="finance" href="utilities.html">
          <i class="bi bi-lightning-charge me-2"></i><span>Utilities</span>
        </a>
        <a class="nav-link d-flex align-items-center" data-role="admin" href="cashflow.html">
          <i class="bi bi-cash-stack me-2"></i><span>Cash Flow</span>
        </a>
        <a class="nav-link d-flex align-items-center" data-role="admin" href="admin-settings.html">
          <i class="bi bi-gear me-2"></i><span>Admin Settings</span>
        </a>
      </nav>
    </aside>

    <!-- MAIN CONTENT -->
    <div id="main" class="main flex-grow-1">
      <main class="content p-4">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h2>Residential Management</h2>
          <div class="d-flex gap-2">
            <button class="btn btn-gold" data-bs-toggle="modal" data-bs-target="#newBookingModal">
              <i class="bi bi-plus-circle me-1"></i>New Booking
            </button>
            <button class="btn btn-outline-gold" id="generateReportBtn">
              <i class="bi bi-file-earmark-text me-1"></i>Generate Report
            </button>
          </div>
        </div>

        <!-- STATS CARDS -->
        <div class="row g-3 mb-4">
          <div class="col-6 col-md-3">
            <div class="card stat-card">
              <div class="card-body">
                <div class="stat-title">Total Rooms</div>
                <div class="stat-value" id="totalRooms">24</div>
                <div class="text-muted small">Single: 12, Double: 8, VIP: 4</div>
              </div>
            </div>
          </div>

          <div class="col-6 col-md-3">
            <div class="card stat-card">
              <div class="card-body">
                <div class="stat-title">Occupied</div>
                <div class="stat-value" id="occupiedRooms">16</div>
                <div class="text-muted small">67% occupancy</div>
              </div>
            </div>
          </div>

          <div class="col-6 col-md-3">
            <div class="card stat-card">
              <div class="card-body">
                <div class="stat-title">Today Check-ins</div>
                <div class="stat-value" id="todayCheckins">3</div>
                <div class="text-muted small">2 pending checkouts</div>
              </div>
            </div>
          </div>

          <div class="col-6 col-md-3">
            <div class="card stat-card">
              <div class="card-body">
                <div class="stat-title">Monthly Revenue</div>
                <div class="stat-value" id="monthlyRevenue">₨245,800</div>
                <div class="text-muted small">+12% from last month</div>
              </div>
            </div>
          </div>
        </div>

        <!-- MAIN CONTENT AREA -->
        <div class="row g-4">
          <!-- LEFT COLUMN: Rooms & Calendar -->
          <div class="col-12 col-lg-8">
            <!-- Room List -->
            <div class="card mb-4">
              <div class="card-body">
                <div class="d-flex justify-content-between align-items-center mb-3 mobileview">
                  <h5 class="card-title mb-0">Rooms & Availability</h5>
                  <div class="btn-group">
                    <button class="btn btn-sm btn-outline-secondary active" data-filter="all">All</button>
                    <button class="btn btn-sm btn-outline-secondary" data-filter="single">Single</button>
                    <button class="btn btn-sm btn-outline-secondary" data-filter="double">Double</button>
                    <button class="btn btn-sm btn-outline-secondary" data-filter="vip">VIP</button>
                  </div>
                </div>
                
                <div class="row g-3" id="roomsContainer">
                  <!-- Rooms will be loaded dynamically -->
                </div>
              </div>
            </div>

            <!-- Booking Calendar -->
            <div class="card">
              <div class="card-body">
                <h5 class="card-title mb-3">Booking Calendar</h5>
                <div class="calendar-container" id="bookingCalendar"></div>
              </div>
            </div>
          </div>

          <!-- RIGHT COLUMN: Bookings & Actions -->
          <div class="col-12 col-lg-4">
            <!-- Current Bookings -->
            <div class="card mb-4">
              <div class="card-body">
                <h5 class="card-title mb-3">Current Bookings</h5>
                <div class="booking-timeline" id="currentBookings">
                  <!-- Bookings will be loaded dynamically -->
                </div>
              </div>
            </div>

            <!-- Quick Actions -->
            <div class="card mb-4">
              <div class="card-body">
                <h5 class="card-title mb-3">Quick Actions</h5>
                <div class="d-grid gap-2">
                  <button class="btn btn-outline-gold" data-bs-toggle="modal" data-bs-target="#checkinModal">
                    <i class="bi bi-box-arrow-in-right me-2"></i>Check-in
                  </button>
                  <button class="btn btn-outline-gold" data-bs-toggle="modal" data-bs-target="#checkoutModal">
                    <i class="bi bi-box-arrow-right me-2"></i>Check-out
                  </button>
                  <button class="btn btn-outline-gold" data-bs-toggle="modal" data-bs-target="#housekeepingModal">
                    <i class="bi bi-bucket me-2"></i>Update Housekeeping
                  </button>
                  <button class="btn btn-outline-gold" id="viewOccupancyBtn">
                    <i class="bi bi-graph-up me-2"></i>View Occupancy Report
                  </button>
                </div>
              </div>
            </div>

            <!-- Housekeeping Status -->
            <div class="card">
              <div class="card-body">
                <h5 class="card-title mb-3">Housekeeping Status</h5>
                <div class="table-responsive">
                  <table class="table table-sm">
                    <thead>
                      <tr>
                        <th>Room</th>
                        <th>Status</th>
                        <th>Last Cleaned</th>
                      </tr>
                    </thead>
                    <tbody id="housekeepingTable">
                      <!-- Housekeeping data will be loaded dynamically -->
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- BOTTOM SECTION: Reports & History -->
        <div class="row g-4 mt-2">
          <!-- Occupancy Chart -->
          <div class="col-12 col-lg-6">
            <div class="card">
              <div class="card-body">
                <h5 class="card-title mb-3">Occupancy Trend (Last 7 Days)</h5>
                <div class="occupancy-chart">
                  <canvas id="occupancyChart"></canvas>
                </div>
              </div>
            </div>
          </div>

          <!-- Recent Cancellations -->
          <div class="col-12 col-lg-6">
            <div class="card">
              <div class="card-body">
                <div class="d-flex justify-content-between align-items-center mb-3">
                  <h5 class="card-title mb-0">Recent Cancellations</h5>
                  <a href="#" class="small">View All</a>
                </div>
                <div class="table-responsive">
                  <table class="table table-sm">
                    <thead>
                      <tr>
                        <th>Booking ID</th>
                        <th>Member</th>
                        <th>Refund</th>
                        <th>Status</th>
                      </tr>
                    </thead>
                    <tbody id="cancellationsTable">
                      <!-- Cancellations will be loaded dynamically -->
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>
  </div>

  <!-- MODALS -->

  <!-- New Booking Modal -->
  <div class="modal fade" id="newBookingModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">New Room Booking</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="bookingForm">
            <div class="row g-3">
              <div class="col-md-6">
                <label class="form-label">Select Member</label>
                <select class="form-select" id="memberSelect" required>
                  <option value="">Choose member...</option>
                  <!-- Members will be loaded dynamically -->
                </select>
              </div>
              <div class="col-md-6">
                <label class="form-label">Room Type</label>
                <select class="form-select" id="roomTypeSelect" required>
                  <option value="">Select type...</option>
                  <option value="single">Single Room (₨5,000/day)</option>
                  <option value="double">Double Room (₨8,000/day)</option>
                  <option value="vip">VIP Suite (₨15,000/day)</option>
                </select>
              </div>
              <div class="col-md-6">
                <label class="form-label">Check-in Date</label>
                <input type="date" class="form-control" id="checkinDate" required>
              </div>
              <div class="col-md-6">
                <label class="form-label">Check-out Date</label>
                <input type="date" class="form-control" id="checkoutDate" required>
              </div>
              <div class="col-md-6">
                <label class="form-label">Number of Guests</label>
                <input type="number" class="form-control" id="numGuests" min="1" max="4" value="1">
              </div>
              <div class="col-md-6">
                <label class="form-label">Special Requests</label>
                <textarea class="form-control" id="specialRequests" rows="1"></textarea>
              </div>
              <div class="col-12">
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="autoInvoice">
                  <label class="form-check-label">
                    Automatically add charges to member invoice
                  </label>
                </div>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-gold" id="confirmBooking">Create Booking</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Check-in Modal -->
  <div class="modal fade" id="checkinModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Check-in Guest</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="checkinForm">
            <div class="mb-3">
              <label class="form-label">Booking ID</label>
              <input type="text" class="form-control" id="checkinBookingId" placeholder="Enter booking ID">
            </div>
            <div class="mb-3">
              <label class="form-label">Payment Method</label>
              <select class="form-select" id="paymentMethod">
                <option value="cash">Cash</option>
                <option value="card">Credit Card</option>
                <option value="invoice">Add to Invoice</option>
              </select>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-gold" id="confirmCheckin">Process Check-in</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Check-out Modal -->
  <div class="modal fade" id="checkoutModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Check-out Guest</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="checkoutForm">
            <div class="mb-3">
              <label class="form-label">Room Number</label>
              <input type="text" class="form-control" id="checkoutRoom" placeholder="Enter room number">
            </div>
            <div class="mb-3">
              <label class="form-label">Additional Charges</label>
              <div class="input-group">
                <span class="input-group-text">₨</span>
                <input type="number" class="form-control" id="additionalCharges" value="0" min="0">
              </div>
              <div class="form-text">Enter any additional charges (damages, extra services, etc.)</div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-gold" id="confirmCheckout">Process Check-out</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Housekeeping Update Modal -->
  <div class="modal fade" id="housekeepingModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Update Housekeeping Status</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="housekeepingForm">
            <div class="mb-3">
              <label class="form-label">Room Number</label>
              <input type="text" class="form-control" id="hkRoomNumber" placeholder="Enter room number">
            </div>
            <div class="mb-3">
              <label class="form-label">Status</label>
              <select class="form-select" id="hkStatus">
                <option value="clean">Clean</option>
                <option value="cleaning_in_progress">Cleaning in Progress</option>
                <option value="maintenance">Maintenance Required</option>
                <option value="dirty">Dirty</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">Notes</label>
              <textarea class="form-control" id="hkNotes" rows="2"></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-gold" id="confirmHousekeeping">Update Status</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Occupancy Report Modal -->
  <div class="modal fade" id="occupancyReportModal" tabindex="-1">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Occupancy & Revenue Report</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="row mb-4">
            <div class="col-md-4">
              <div class="form-group">
                <label>Date Range</label>
                <input type="text" class="form-control" id="reportDateRange" placeholder="Select date range">
              </div>
            </div>
            <div class="col-md-4">
              <div class="form-group">
                <label>Room Type</label>
                <select class="form-select" id="reportRoomType">
                  <option value="all">All Types</option>
                  <option value="single">Single</option>
                  <option value="double">Double</option>
                  <option value="vip">VIP</option>
                </select>
              </div>
            </div>
            <div class="col-md-4">
              <div class="form-group">
                <label>Report Type</label>
                <select class="form-select" id="reportType">
                  <option value="occupancy">Occupancy</option>
                  <option value="revenue">Revenue</option>
                  <option value="both">Both</option>
                </select>
              </div>
            </div>
          </div>
          <div id="reportContent">
            <!-- Report will be generated here -->
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-gold" id="printReportBtn">
            <i class="bi bi-printer me-1"></i>Print Report
          </button>
          <button type="button" class="btn btn-outline-gold" id="exportReportBtn">
            <i class="bi bi-download me-1"></i>Export
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Scripts -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<!-- FullCalendar JS -->
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<!-- Moment.js (required for daterangepicker) -->
<script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/moment.min.js"></script>
<!-- Date Range Picker -->
<script src="https://cdn.jsdelivr.net/npm/daterangepicker@3.1.0/daterangepicker.js"></script>
<!-- App JS -->
<script src="assets/js/residential.js"></script>
  <script>
    // Mobile Menu Toggle Script
    document.addEventListener('DOMContentLoaded', function () {
      const mobileToggle = document.getElementById('mobileMenuToggle');
      const sidebar = document.getElementById('sidebar');

      if (mobileToggle && sidebar) {
        mobileToggle.addEventListener('click', function () {
          sidebar.classList.toggle('active');
        });

        // Close sidebar when clicking outside on mobile
        document.addEventListener('click', function (event) {
          if (window.innerWidth <= 768) {
            if (!sidebar.contains(event.target) && !mobileToggle.contains(event.target)) {
              sidebar.classList.remove('active');
            }
          }
        });

        // Close sidebar when clicking a nav link on mobile
        document.querySelectorAll('.sidebar .nav-link').forEach(link => {
          link.addEventListener('click', function () {
            if (window.innerWidth <= 768) {
              sidebar.classList.remove('active');
            }
          });
        });
      }
    });
  </script>
</body>

</html>